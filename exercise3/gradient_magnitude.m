function [Imag,Idir] = gradient_magnitude(I,sigma)